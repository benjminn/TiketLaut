<Window x:Class="TiketLaut.Views.CekBookingWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:components="clr-namespace:TiketLaut.Views.Components"
        Title="Tiket Laut - Cek Booking" 
        Height="900" 
        Width="1400"
        WindowStartupLocation="CenterScreen"
        Background="#F2F5FC"
        FontFamily="Plus Jakarta Sans">

    <Window.Resources>
        <!-- Shadow Effect -->
        <DropShadowEffect x:Key="CardShadow" 
                         BlurRadius="10" 
                         ShadowDepth="3" 
                         Opacity="0.15" 
                         Color="#000000"/>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Navbar Component -->
        <components:NavbarPostLogin Grid.Row="0" 
                                    x:Name="navbarPostLogin"
                                    VerticalAlignment="Top"
                                    Panel.ZIndex="999"/>

        <!-- Main Content -->
    <ScrollViewer x:Name="mainScrollViewer"
              Grid.Row="1"
              VerticalScrollBarVisibility="Auto"
              ScrollChanged="MainScrollViewer_ScrollChanged">
            <StackPanel Margin="95,30,95,50">
                    
                    <!-- Header Card -->
                    <Border Background="White" 
                           CornerRadius="30" 
                           Padding="40,30"
                           Effect="{StaticResource CardShadow}"
                           Margin="0,0,0,30">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Title -->
                            <TextBlock Grid.Column="0" 
                                      Text="Pesanan Saya" 
                                      FontSize="28" 
                                      FontWeight="Bold" 
                                      Foreground="Black" 
                                      VerticalAlignment="Center"/>

                            <!-- Riwayat Button -->
                            <Button Grid.Column="1" 
                                   x:Name="btnRiwayat"
                                   Click="BtnRiwayat_Click"
                                   Background="Transparent" 
                                   BorderThickness="0" 
                                   Cursor="Hand">
                                <StackPanel Orientation="Horizontal">
                                    <Image Source="/Views/Assets/Icons/iconhistory.png" 
                                          Width="24" 
                                          Height="24" 
                                          Margin="0,0,10,0"/>
                                    <TextBlock Text="Riwayat pesanan" 
                                              FontSize="20" 
                                              FontWeight="SemiBold" 
                                              Foreground="#00658D"/>
                                </StackPanel>
                            </Button>
                        </Grid>
                    </Border>

                    <!-- Filter & Sort Buttons -->
                    <Grid Margin="0,0,0,30">
                    <StackPanel Orientation="Horizontal">
                        <!-- Filter Button -->
                        <Button x:Name="btnFilter"
                               Background="White"
                               BorderBrush="#042769" 
                               BorderThickness="0.5"
                               Padding="30,15" 
                               Margin="0,0,15,0"
                               Cursor="Hand"
                               Click="BtnFilter_Click">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="borderFilter"
                                           Background="{TemplateBinding Background}"
                                           BorderBrush="{TemplateBinding BorderBrush}"
                                           BorderThickness="{TemplateBinding BorderThickness}"
                                           CornerRadius="25"
                                           Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                            <StackPanel Orientation="Horizontal">
                                <Image Source="/Views/Assets/Icons/iconfilter.png" 
                                       Width="20" 
                                       Height="20" 
                                       Margin="0,0,10,0"/>
                                <TextBlock x:Name="txtFilter"
                                          Text="Filter" 
                                          FontSize="20" 
                                          FontWeight="Medium" 
                                          Foreground="#00B4B5"/>
                            </StackPanel>
                        </Button>

                        <!-- Sort Button -->
                        <Button x:Name="btnSort"
                               Background="White"
                               BorderBrush="#042769" 
                               BorderThickness="0.5"
                               Padding="30,15"
                               Cursor="Hand"
                               Click="BtnSort_Click">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border x:Name="borderSort"
                                           Background="{TemplateBinding Background}"
                                           BorderBrush="{TemplateBinding BorderBrush}"
                                           BorderThickness="{TemplateBinding BorderThickness}"
                                           CornerRadius="25"
                                           Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                </ControlTemplate>
                            </Button.Template>
                            <StackPanel Orientation="Horizontal">
                                <Image Source="/Views/Assets/Icons/iconsort.png" 
                                       Width="20" 
                                       Height="20" 
                                       Margin="0,0,10,0"/>
                                <TextBlock x:Name="txtSort"
                                          Text="Urutkan" 
                                          FontSize="20" 
                                          FontWeight="Medium" 
                                          Foreground="#00B4B5"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                    
                    <!-- Filter Popup -->
                    <Popup x:Name="popupFilter"
                          PlacementTarget="{Binding ElementName=btnFilter}"
                          Placement="Bottom"
                          AllowsTransparency="True"
                          StaysOpen="False"
                          Opened="PopupFilter_Opened"
                          Closed="PopupFilter_Closed">
                                <Border Background="White"
                                       BorderBrush="#00B4B5"
                                       BorderThickness="2"
                                       CornerRadius="15"
                                       Padding="30"
                                       MinWidth="300">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="20" 
                                                         ShadowDepth="5" 
                                                         Opacity="0.25"/>
                                    </Border.Effect>
                                    <StackPanel>
                                        <TextBlock Text="Filter Status Pesanan" 
                                                  FontSize="18" 
                                                  FontWeight="Bold" 
                                                  Foreground="#042769"
                                                  Margin="0,0,0,20"/>
                                        
                                        <!-- Filter Options -->
                                        <CheckBox x:Name="chkSemua"
                                                 Content="Semua Status"
                                                 FontSize="15"
                                                 Margin="0,0,0,12"
                                                 IsChecked="True"
                                                 Checked="FilterOption_Changed"
                                                 Unchecked="FilterOption_Changed"
                                                 Foreground="#042769"/>
                                        <CheckBox x:Name="chkMenungguPembayaran"
                                                 Content="Menunggu Pembayaran"
                                                 FontSize="15"
                                                 Margin="0,0,0,12"
                                                 Checked="FilterOption_Changed"
                                                 Unchecked="FilterOption_Changed"
                                                 Foreground="#042769"/>
                                        <CheckBox x:Name="chkMenungguValidasi"
                                                 Content="Menunggu Validasi"
                                                 FontSize="15"
                                                 Margin="0,0,0,12"
                                                 Checked="FilterOption_Changed"
                                                 Unchecked="FilterOption_Changed"
                                                 Foreground="#042769"/>
                                        <CheckBox x:Name="chkSukses"
                                                 Content="Sukses"
                                                 FontSize="15"
                                                 Margin="0,0,0,12"
                                                 Checked="FilterOption_Changed"
                                                 Unchecked="FilterOption_Changed"
                                                 Foreground="#042769"/>
                                        <CheckBox x:Name="chkGagal"
                                                 Content="Gagal"
                                                 FontSize="15"
                                                 Checked="FilterOption_Changed"
                                                 Unchecked="FilterOption_Changed"
                                                 Foreground="#042769"/>
                                    </StackPanel>
                                </Border>
                    </Popup>
                    
                    <!-- Sort Popup -->
                    <Popup x:Name="popupSort"
                          PlacementTarget="{Binding ElementName=btnSort}"
                          Placement="Bottom"
                          AllowsTransparency="True"
                          StaysOpen="False"
                          Opened="PopupSort_Opened"
                          Closed="PopupSort_Closed">
                                <Border Background="White"
                                       BorderBrush="#00B4B5"
                                       BorderThickness="2"
                                       CornerRadius="15"
                                       Padding="30"
                                       MinWidth="300">
                                    <Border.Effect>
                                        <DropShadowEffect BlurRadius="20" 
                                                         ShadowDepth="5" 
                                                         Opacity="0.25"/>
                                    </Border.Effect>
                                    <StackPanel>
                                        <TextBlock Text="Urutkan Pesanan" 
                                                  FontSize="18" 
                                                  FontWeight="Bold" 
                                                  Foreground="#042769"
                                                  Margin="0,0,0,20"/>
                                        
                                        <!-- Sort Options -->
                                        <RadioButton x:Name="rbTanggalTerbaru"
                                                    Content="Tanggal Terbaru"
                                                    FontSize="15"
                                                    GroupName="Sort"
                                                    Margin="0,0,0,12"
                                                    IsChecked="True"
                                                    Checked="SortOption_Changed"
                                                    Foreground="#042769"/>
                                        <RadioButton x:Name="rbTanggalTerlama"
                                                    Content="Tanggal Terlama"
                                                    FontSize="15"
                                                    GroupName="Sort"
                                                    Margin="0,0,0,12"
                                                    Checked="SortOption_Changed"
                                                    Foreground="#042769"/>
                                        <RadioButton x:Name="rbHargaTertinggi"
                                                    Content="Harga Tertinggi"
                                                    FontSize="15"
                                                    GroupName="Sort"
                                                    Margin="0,0,0,12"
                                                    Checked="SortOption_Changed"
                                                    Foreground="#042769"/>
                                        <RadioButton x:Name="rbHargaTerendah"
                                                    Content="Harga Terendah"
                                                    FontSize="15"
                                                    GroupName="Sort"
                                                    Checked="SortOption_Changed"
                                                    Foreground="#042769"/>
                                    </StackPanel>
                                </Border>
                    </Popup>
                    </Grid>

                    <!-- Booking List -->
                    <ItemsControl x:Name="icBookingList">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <!-- Booking Card -->
                                <Border Background="#FEFEFE" 
                                       CornerRadius="28" 
                                       BorderBrush="#042769" 
                                       BorderThickness="1" 
                                       Padding="30,30" 
                                       Margin="0,0,0,20"
                                       Cursor="Hand"
                                       MouseLeftButtonDown="BookingCard_Click">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Booking Info -->
                                        <StackPanel Grid.Column="0">
                                            <!-- Route & Status -->
                                            <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                                <TextBlock Text="{Binding Route}" 
                                                          FontSize="24" 
                                                          FontWeight="SemiBold" 
                                                          Foreground="Black"/>
                                                
                                                <Ellipse Width="10" 
                                                        Height="10" 
                                                        Fill="{Binding StatusColor}" 
                                                        Margin="15,0,10,0" 
                                                        VerticalAlignment="Center"/>
                                                
                                                <TextBlock Text="{Binding Status}" 
                                                          FontSize="24" 
                                                          FontWeight="SemiBold" 
                                                          Foreground="{Binding StatusColor}"/>
                                            </StackPanel>

                                            <!-- Ship Name -->
                                            <TextBlock Text="{Binding ShipName}" 
                                                      FontSize="16" 
                                                      FontWeight="SemiBold" 
                                                      Foreground="#00658D" 
                                                      Margin="0,0,0,20"/>

                                            <!-- Date & Time -->
                                            <StackPanel Orientation="Horizontal">
                                                <TextBlock Text="{Binding Date}" 
                                                          FontSize="16" 
                                                          FontWeight="Bold" 
                                                          Foreground="#042769"/>
                                                
                                                <Rectangle Fill="#00B4B5" 
                                                          Width="1.5" 
                                                          Height="20" 
                                                          Margin="15,0"/>
                                                
                                                <TextBlock Text="{Binding Time}" 
                                                          FontSize="16" 
                                                          FontWeight="Bold" 
                                                          Foreground="#042769"/>
                                            </StackPanel>

                                            <!-- Warning Message (if applicable) -->
                                            <Border Background="#FFD3C5" 
                                                   CornerRadius="8" 
                                                   Padding="15,10" 
                                                   Margin="0,15,0,0"
                                                   HorizontalAlignment="Left"
                                                   Visibility="{Binding ShowWarning}">
                                                <StackPanel Orientation="Horizontal">
                                                    <Image Source="/Views/Assets/Icons/iconinfo.png" 
                                                           Width="24" 
                                                           Height="24" 
                                                           Margin="0,0,10,0"/>
                                                    <TextBlock Text="{Binding WarningText}" 
                                                              FontSize="16" 
                                                              FontWeight="Medium" 
                                                              Foreground="#00658D" 
                                                              VerticalAlignment="Center"/>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>

                                        <!-- Arrow Icon -->
                                        <Image Grid.Column="1" 
                                               Source="/Views/Assets/Icons/iconarrowright.png"
                                               Width="30" 
                                               Height="30" 
                                               VerticalAlignment="Top"/>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>

                </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
